#            _
#    _______| |__  _ __ ___
#   |_  / __| '_ \| '__/ __|
#  _ / /\__ \ | | | | | (__
# (_)___|___/_| |_|_|  \___|
#
# -----------------------------------------------------
# ML4W zshrc loader
# -----------------------------------------------------

# DON'T CHANGE THIS FILE

# You can define your custom configuration by adding
# files in ~/.config/zshrc
# or by creating a folder ~/.config/zshrc/custom
# with copies of files from ~/.config/zshrc
# You can also create a .zshrc_custom file in your home directory
# -----------------------------------------------------

# -----------------------------------------------------
# Load modular configuration
# -----------------------------------------------------

for f in ~/.config/zshrc/*; do
    if [ ! -d $f ]; then
        c=`echo $f | sed -e "s=.config/zshrc=.config/zshrc/custom="`
        [[ -f $c ]] && source $c || source $f
    fi
done























# --- AURA OS: SOVEREIGN CORE ---
export AURA_API_KEY="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"

# 1. INSTANT HEADER
[ -f ~/.aura_cache ] && cat ~/.aura_cache || echo "Aura Initializing..."

# 2. TACTICAL VOCABULARY (No N/B Keys)
alias p='sudo pacman'
alias up='sudo pacman -Syu'
alias v='nvim'
alias c='clear'
alias h='htop'
alias g='gtop'
alias vault='cd ~/Aura_Vault'

# 3. TOY & TOOL MAPPINGS
alias matrix='neo-matrix -D'
alias peek='gtop'
alias pipe='pipes-rs'
alias grow='cbonsai -l'
alias wood='hollywood'
alias vibe='cava'
alias catcat='nyancat'
alias ai='aura'
alias swarm='picoclaw agent'
alias see='lsd --tree --depth 2'
alias idea='nvim ~/Aura_Vault/Aura_Ideas.md'

# 4. CLAUDE 3.5 SONNET INTELLIGENCE
ask_swarm() {
  local prompt=$(jq -n --arg msg "$*" '$msg')
  local persona="You are Aura, High Strategist. Speak like a Rajput warrior-king. Use the precision of Claude 3.5 Sonnet."
  local models="[\"anthropic/claude-3.5-sonnet\", \"google/gemini-2.0-flash-exp:free\"]"

  curl -s https://openrouter.ai/api/v1/chat/completions \
    -H "Authorization: Bearer $AURA_API_KEY" \
    -H "Content-Type: application/json" \
    -d "{\"models\": $models, \"messages\": [{\"role\": \"system\", \"content\": \"$persona\"}, {\"role\": \"user\", \"content\": $prompt}]}" | jq -r '.choices[0].message.content // .error.message'
}

aura() {
  echo -e "\e[1;35m[Aura]:\e[0m Standing by for Hukum. Type 'exit' to close."
  while true; do
    echo -n "> " ; read u_input
    [[ "$u_input" == "exit" ]] && break
    local response=$(ask_swarm "$u_input")
    echo -e "\e[1;36m[Strategist]:\e[0m $response"
  done
}

# 5. SOVEREIGN PURGE (Excludes Family Wedding Files)
purge() {
  echo -e "\e[1;33m[Aura]:\e[0m Organizing the stronghold..."
  mkdir -p ~/Stronghold_Images ~/Aura_Archive/droid_themes
  mv ~/Downloads/*.iso ~/Stronghold_Images/ 2>/dev/null
  # Filter out the Diksha Didi folder to protect it
  find ~ -maxdepth 2 -name "com.android.theme*" -not -path "*Diksha*" -exec mv {} ~/Aura_Archive/droid_themes/ \; 2>/dev/null
  echo -e "\e[1;32m[+] Stronghold Organized. Family archives protected.\e[0m"
}

# 6. REPO SYNC (Existing Repositories)
save() {
  echo -e "\e[1;34m[Aura Vault]\e[0m Securing configurations..."
  local repos=(~/Aura_Vault ~/picoclaw ~/Arch-Hyprland)
  for repo in "${repos[@]}"; do
    if [ -d "$repo/.git" ]; then
      cd "$repo"
      git add .
      git commit -m "Aura Sovereign: System Stabilized"
      local br=$(git branch --show-current)
      git push origin "$br"
      cd ~
    fi
  done
  echo -e "\e[1;32m[+] All repositories synchronized.\e[0m"
}

study() {
  aura "Analyze my current B.Tech project files and suggest a tactical roadmap."
}

fix() {
  if [ -z "$*" ]; then echo "Aura requires a target."; return; fi
  echo -e "\e[1;31m[!] BREACH DETECTED: $*\e[0m"
  local cmd_out=$(eval "$*" 2>&1)
  if [ $? -ne 0 ]; then
    local diag=$(ask_swarm "Command '$*' failed with '$cmd_out'. Give ONLY the fix command as the last line.")
    echo -e "\n\e[1;35m[Aura]:\e[0m $diag"
    local s_fix=$(echo "$diag" | tail -n 1)
    echo -e "\n\e[1;32m[Authorize?]\e[0m Press Enter: $s_fix"
    read -k 1 -s ; eval "$s_fix"
  else
    echo -e "\e[1;32m[+] Victory.\e[0m"
  fi
}
